<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Use correct character set. -->
    <meta charset="utf-8" />
    <!-- Tell IE to use the latest, best version. -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- Make the application on mobile take up the full browser screen and disable user scaling. -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <title>JARTIC Traffic Volume Analysis</title>
    <script src="../../Build/Cesium/Cesium.js"></script>
    <style>
      @import url(../../Build/Cesium/Widgets/widgets.css);
      html,
      body,
      #cesiumContainer {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <div id="cesiumContainer"></div>
    <script>
      var viewer = new Cesium.Viewer("cesiumContainer", {shouldAnimate: true,});
	  
	  var czml ="demo.czml";
	  
	  var dataSource = new Cesium.CzmlDataSource();
		function scaleProperty(property, scalingFactor) {
		  // returns a property that scales another property by a constant factor.
		  return new Cesium.CallbackProperty(function (time, result) {
			result = property.getValue(time, result);
			result = result * scalingFactor;
			return result;
		  }, property.isConstant);
		}

		function setExtrudedHeight(propertyName) {
		  var customPropertyObject = dataSource.entities.getById(
			"custom_property_object"
		  );
		  var property = customPropertyObject.properties[propertyName];
		  var colorado = dataSource.entities.getById("colorado");
		  colorado.polygon.extrudedHeight = scaleProperty(property, 1 / 50.0);
		}

		// Custom properties can be used as the value of graphical properties:
		Sandcastle.addToolbarMenu(
		  [
			{
			  text: "Use interval data",
			  onselect: function () {
				setExtrudedHeight("population_intervals");
			  },
			},
			{
			  text: "Use sampled data",
			  onselect: function () {
				setExtrudedHeight("population_sampled");
			  },
			},
		  ],
		  "propertiesMenu"
		);

		dataSource.load(czml);
		viewer.dataSources.add(dataSource);
		viewer.zoomTo(dataSource);

	  //var imgPrvdr = new Cesium.UrlTemplateImageryProvider(
	 //	{ url: 'https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png', maximumLevel: 18});
	 // var curimg = viewer.scene.imageryLayers.addImageryProvider(imgPrvdr);
	  //viewer.camera.flyTo({destination : Cesium.Cartesian3.fromDegrees(139.754813, 35.677730, 45000.0)});
    </script>
  </body>
</html>
